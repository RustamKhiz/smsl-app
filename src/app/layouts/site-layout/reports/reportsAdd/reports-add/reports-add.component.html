<!-- [formGroup]="formSub" (ngSubmit)="reportSubmit()" -->
<div class="reports">
    <form>
        <p class="reports-title">Создание отчёта</p>
        <div class="reports-wrap">
            <div class="reports-wrap-wrap">
                <div class="reports-tabs-wrap">
                    <div class="reports-tab" (click)="tabsClick()" [ngClass]="{reportActive:tabsBg}">
                        <p class="tab-text tab-border">Наименование выполняемых работ</p>
                    </div>
                    <div class="reports-tab" (click)="tabsClick2()" [ngClass]="{reportActive:tabsBg2}">
                        <p class="tab-text tab-border">Персонал</p>
                    </div>
                    <div class="reports-tab" (click)="tabsClick3()" [ngClass]="{reportActive:tabsBg3}">
                        <p class="tab-text">Оборудование</p>
                    </div>


                </div>
                <div class="reports-tab-file">
                    <p class="file-item" *ngFor="let file of reportFile, index as i">{{[i+1] + ". " + file.OriginalName}}<span> <img src="assets/delete-black.png" class="file-delete" (click)="reportFile.splice(i, 1)"> </span> </p>
                    <label class="file-add" for="file">Добавить файл + </label>
                    <input type="file" id="file" hidden (change)="fileChange($event)" multiple placeholder="Upload file" accept=".pdf,.doc,.docx,.png,.jpg,.xlsx,.xls">
                </div>
            </div>

            <div class="reports-content-wrap">
                <div class="reports-name-wrap">
                    <div class="reports-name-noarrow">
                        <app-dropdown-select [ItemsData]="LocationData" [ItemsCtrl]="LocationCtrl" [placeholder]="'Выберите локацию'" (itemSelect)="LocationIdAdd($event)"></app-dropdown-select>

                    </div>
                    <div class="reports-name-noarrow">
                        <app-dropdown-select [ItemsData]="PersData" [ItemsCtrl]="ChiefCtrl" [placeholder]="'Выберите сотрудников'" (itemSelect)="ChiefIdAdd($event)"></app-dropdown-select>
                    </div>
                    <div class="reports-name-noarrow">
                        <mat-form-field appearance="fill" color="accent">
                            <mat-label>Введите дату</mat-label>
                            <input matInput [matDatepicker]="picker" [formControl]="DataReportCtrl">
                            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                            <mat-datepicker #picker></mat-datepicker>
                        </mat-form-field>
                    </div>
                </div>
                <div class="reports-content" [ngClass]="{cardActive:cardAct}">

                    <div class="report-content" *ngFor="let card of reportsCards, index as i">
                        <div class="report-content-text">
                            <div>
                                <p>
                                    <strong>Метод НК:</strong><br> {{card.MethodControl}}
                                </p>
                                <p>
                                    <strong>Заказчик:</strong><br> {{card.Customer}}
                                </p>
                            </div>
                            <p class="report-content-pers">
                                <strong>Сотрудники:</strong> <span *ngFor="let pers of reportsCards[i].CwrWorkPersonals, index as j">{{[j+1] + ". " + pers.Fio}}</span>
                            </p>
                            <p class="report-content-equip">
                                <strong>Оборудование:</strong> <span *ngFor="let equip of reportsCards[i].CwrWorkEquipments, index as j">{{[j+1] + ". " + equip.Name }}</span>
                            </p>
                            <div>
                                <p>
                                    <strong>Предъявлено:</strong> {{card.Shown}}
                                </p>
                                <p>
                                    <strong>Сделано:</strong> {{card.Made}}
                                </p>
                                <p>
                                    <strong>Комментарий:</strong> {{card.Comment}}
                                </p>
                            </div>
                        </div>

                        <img src="assets/reports-red.png" class="img_red" (click)="CwrWorksRed(i)" alt="">
                        <img src="assets/delete-black.png" class="img_red" (click)="reportsCards.splice(i, 1)" alt="">
                    </div>

                    <div class="report-content-add"><img src="assets/reports-add.png" (click)="popupOpen()" class="img-add" alt=""> </div>
                </div>
                <div class="reports-popup" [ngClass]="{open:popOpenRed}">
                    <div class="popup-area" (click)="popupOpenRed()"></div>
                    <div class="popup-body">
                        <div class="popup-content">
                            <a class="popup-close" (click)="popupOpenRed()">X</a>
                            <div class="popup-title">Наименование выполняемых работ</div>
                            <div class="form">
                                <form>
                                    <div class="select-card-wrap">
                                        <div class="select-wrap">
                                            <p class="select-title">Метод НК</p>
                                            <app-dropdown-select [ItemsData]='MethodData' [ItemsCtrl]="MethodControlCtrl" [placeholder]="'Выберите метод'" [setValue]="MethodControlCtrl.value" (itemSelect)="MethodAdd($event)"></app-dropdown-select>
                                        </div>
                                        <div class="select-wrap">
                                            <p class="select-title">Заказчик</p>
                                            <app-dropdown-select [ItemsData]="CustomerData" [ItemsCtrl]="CustomerCtrl" [placeholder]="'Выберите заказчика'" [setValue]="CustomerCtrl.value" (itemSelect)="CustomerAdd($event)"></app-dropdown-select>

                                        </div>
                                        <div class="select-wrap">
                                            <p class="select-title">Сотрудники</p>
                                            <app-dropdown-multi [ItemsData]="PersData" [ItemsMultiCtrl]="CwrWorkPersonalsCtrl" [allItemsSize]="pers.length" [placeholder]="'Выберите сотрудников'" (itemSelect)="CwrWorkPersonalsAdd($event)"></app-dropdown-multi>

                                        </div>
                                        <div class="select-wrap">
                                            <p class="select-title">Оборудование</p>
                                            <app-dropdown-multi [ItemsData]="EquipData" [ItemsMultiCtrl]="CwrWorkEquipmentsCtrl" [allItemsSize]="equipment.length" [placeholder]="'Выберите оборудование'" (itemSelect)="CwrWorkEquipmentsAdd($event)"></app-dropdown-multi>

                                        </div>
                                        <div class="select-wrap">
                                            <p class="select-title">Предъявлено</p>
                                            <mat-form-field class="example-full-width" appearance="fill" color="accent">
                                                <mat-label>Предъявлено</mat-label>
                                                <input type="number" matInput placeholder="0" [formControl]="ShownCtrl">
                                            </mat-form-field>
                                        </div>
                                        <div class="select-wrap">
                                            <p class="select-title">Сделано</p>
                                            <mat-form-field class="example-full-width" appearance="fill" color="accent">
                                                <mat-label>Сделано</mat-label>
                                                <input type="number" matInput placeholder="0" [formControl]="MadeCtrl">
                                            </mat-form-field>
                                        </div>
                                        <div class="select-wrap area-wrap">
                                            <p class="select-title">Комментарий</p>
                                            <mat-form-field class="example-full-width" appearance="fill" color="accent">
                                                <mat-label>Leave a comment</mat-label>
                                                <textarea matInput placeholder="Ex. It makes me feel..." [formControl]="CommentCtrl"></textarea>
                                            </mat-form-field>
                                        </div>
                                        <div class="select-wrap " *ngIf="(MethodControlCtrl.status && CustomerCtrl.status && CwrWorkPersonalsCtrl.status && CwrWorkEquipmentsCtrl.status && ShownCtrl.status && MadeCtrl.status) == 'INVALID'">
                                            <div class="report-valid valid">
                                                <strong> Не все обязательные поля формы заполнены!</strong>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="button-wrap">
                                        <button type="button" class="add-button" (click)="RedOnPopup()" [disabled]="(MethodControlCtrl.status && CustomerCtrl.status && CwrWorkPersonalsCtrl.status && CwrWorkEquipmentsCtrl.status && ShownCtrl.status && MadeCtrl.status) == 'INVALID'">
                              <p class="button-text" style="font-size: 16px;">Редактировать</p>
                            </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="reports-content" [ngClass]="{cardActive:cardAct2}">
                    <div class="report-content" *ngFor="let card of reportsPers, index as i">
                        <div class="report-content-text normal">
                            <p>
                                <strong> Сотрудники:</strong> <br> {{card.PersonalStatusName}}
                            </p>
                            <p class="report-content-pers">
                                <strong> Функции:</strong> <span *ngFor="let status of reportsPers[i].CwrStatusFromPersonals, index as j">{{[j+1] + ". " + status.DisplayName}}</span>
                            </p>
                            <p>
                                <strong> Комментарий:</strong> <br> {{card.Comment}}
                            </p>
                        </div>
                        <img src="assets/reports-red.png" class="img_red" (click)="CwrPersonalsRed(i)" alt="">
                        <img src="assets/delete-black.png" class="img_red" (click)="reportsPers.splice(i, 1)" alt="">
                    </div>
                    <div class="report-content-add" (click)="popupOpen2()"><img src="assets/reports-add.png" class="img-add" alt=""> </div>
                </div>
                <div class="reports-popup" [ngClass]="{open:popOpenRed2}">
                    <div class="popup-area" (click)="popupOpenRed2()"></div>
                    <div class="popup-body">
                        <div class="popup-content">
                            <a class="popup-close" (click)="popupOpenRed2()">X</a>
                            <div class="popup-title">Персонал</div>
                            <div class="form">
                                <form>
                                    <div class="select-card-wrap">
                                        <div class="select-wrap">
                                            <p class="select-title">Сотрудник ФИО </p>
                                            <app-dropdown-select [ItemsData]="PersData" [ItemsCtrl]="CwrPersonalCtrl" [placeholder]="'Выберите сотрудника'" (itemSelect)="PersonalAdd($event)"></app-dropdown-select>
                                        </div>
                                        <div class="select-wrap">
                                            <p class="select-title">Функции</p>
                                            <app-dropdown-multi [ItemsData]="StatusData" [ItemsMultiCtrl]="StatusCtrl" [allItemsSize]="status.length" [placeholder]="'Выберите функцию'" (itemSelect)="StatusAdd($event)"></app-dropdown-multi>
                                        </div>
                                        <div class="select-wrap area-wrap">
                                            <p class="select-title">Комментарий</p>
                                            <mat-form-field class="example-full-width" appearance="fill" color="accent">
                                                <mat-label>Leave a comment</mat-label>
                                                <textarea matInput placeholder="Ex. It makes me feel..." [formControl]="CommentCtrl2"></textarea>
                                            </mat-form-field>
                                        </div>

                                    </div>
                                    <div class="button-wrap">
                                        <button type="button" class="add-button" (click)="RedOnPopup2()"><p class="button-text" style="font-size: 16px;">Редактировать</p> </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="reports-content" [ngClass]="{cardActive:cardAct3}">
                    <div class="report-content" *ngFor="let card of reportEquip, index as i">
                        <div class="report-content-text">
                            <p>
                                <strong>Оборудование:</strong> <br> {{card.CwrEquipments}}
                            </p>
                            <p>
                                <strong>Статус:</strong> <br> {{card.Status}}
                            </p>
                            <p>
                                <strong> Комментарий:</strong> <br> {{card.Comment}}
                            </p>
                        </div>
                        <img src="assets/reports-red.png" class="img_red" (click)="CwrEquipmentsRed(i)" alt="">
                        <img src="assets/delete-black.png" class="img_red" (click)="reportEquip.splice(i, 1)" alt="">
                    </div>

                    <div class="report-content-add" (click)="popupOpen3()"><img src="assets/reports-add.png" class="img-add" alt=""> </div>
                </div>
                <div class="reports-popup" [ngClass]="{open:popOpenRed3}">
                    <div class="popup-area" (click)="popupOpenRed3()"></div>
                    <div class="popup-body">
                        <div class="popup-content">
                            <a class="popup-close" (click)="popupOpenRed3()">X</a>
                            <div class="popup-title">Оборудование</div>
                            <div class="form">
                                <form>
                                    <div class="select-card-wrap">
                                        <div class="select-wrap">
                                            <p class="select-title">Оборудование</p>
                                            <app-dropdown-select [ItemsData]="EquipData" [ItemsCtrl]="CwrEquipmentslCtrl" [placeholder]="'Выберите оборудование'" (itemSelect)="EquipmentAdd($event)"></app-dropdown-select>

                                        </div>
                                        <div class="select-wrap">
                                            <p class="select-title">Статус</p>
                                            <app-dropdown-select [ItemsData]="StatusEqData" [ItemsCtrl]="StatusEqCtrl" [placeholder]="'Выберите статус'" (itemSelect)="StatusEqAdd($event)"></app-dropdown-select>

                                        </div>
                                        <div class="select-wrap area-wrap">
                                            <p class="select-title">Комментарий</p>
                                            <mat-form-field class="example-full-width" appearance="fill" color="accent">
                                                <mat-label>Leave a comment</mat-label>
                                                <textarea matInput placeholder="Ex. It makes me feel..." [formControl]="CommentCtrl3"></textarea>
                                            </mat-form-field>
                                        </div>

                                    </div>
                                    <div class="button-wrap">
                                        <button type="button" class="add-button" (click)="RedOnPopup3()"><p class="button-text" style="font-size: 16px;">Редактировать</p> </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>



            </div>
        </div>

        <div class="reports-popup" [ngClass]="{open:popOpen}">
            <div class="popup-area" (click)="popupOpen()"></div>
            <div class="popup-body">
                <div class="popup-content">
                    <a class="popup-close" (click)="popupOpen()">X</a>
                    <div class="popup-title">Наименование выполняемых работ</div>
                    <div class="form" (ngSubmit)='addOnPopup()'>
                        <form (ngSubmit)='addOnPopup()'>
                            <div class="select-card-wrap">
                                <div class="select-wrap">
                                    <p class="select-title">Метод НК</p>
                                    <app-dropdown-select [ItemsData]='MethodData' [ItemsCtrl]="MethodControlCtrl" [placeholder]="'Выберите метод'" (itemSelect)="MethodAdd($event)"></app-dropdown-select>
                                </div>
                                <div class="select-wrap">
                                    <p class="select-title">Заказчик</p>
                                    <app-dropdown-select [ItemsData]="CustomerData" [ItemsCtrl]="CustomerCtrl" [placeholder]="'Выберите заказчика'" (itemSelect)="CustomerAdd($event)"></app-dropdown-select>

                                </div>
                                <div class="select-wrap">
                                    <p class="select-title">Сотрудники</p>
                                    <app-dropdown-multi [ItemsData]="PersData" [ItemsMultiCtrl]="CwrWorkPersonalsCtrl" [allItemsSize]="pers.length" [placeholder]="'Выберите сотрудников'" (itemSelect)="CwrWorkPersonalsAdd($event)"></app-dropdown-multi>

                                </div>
                                <div class="select-wrap">
                                    <p class="select-title">Оборудование</p>
                                    <app-dropdown-multi [ItemsData]="EquipData" [ItemsMultiCtrl]="CwrWorkEquipmentsCtrl" [allItemsSize]="equipment.length" [placeholder]="'Выберите оборудование'" (itemSelect)="CwrWorkEquipmentsAdd($event)"></app-dropdown-multi>

                                </div>
                                <div class="select-wrap">
                                    <p class="select-title">Предъявлено</p>
                                    <mat-form-field class="example-full-width" appearance="fill" color="accent">
                                        <mat-label>Предъявлено</mat-label>
                                        <input type="number" matInput placeholder="0" [formControl]="ShownCtrl">
                                    </mat-form-field>
                                </div>
                                <div class="select-wrap">
                                    <p class="select-title">Сделано</p>
                                    <mat-form-field class="example-full-width" appearance="fill" color="accent">
                                        <mat-label>Сделано</mat-label>
                                        <input type="number" matInput placeholder="0" [formControl]="MadeCtrl">
                                    </mat-form-field>
                                </div>
                                <div class="select-wrap area-wrap">
                                    <p class="select-title">Комментарий</p>
                                    <mat-form-field class="example-full-width" appearance="fill" color="accent">
                                        <mat-label>Leave a comment</mat-label>
                                        <textarea matInput placeholder="Ex. It makes me feel..." [formControl]="CommentCtrl"></textarea>
                                    </mat-form-field>
                                </div>
                                <div class="select-wrap " *ngIf="(MethodControlCtrl.status && CustomerCtrl.status && CwrWorkPersonalsCtrl.status && CwrWorkEquipmentsCtrl.status && ShownCtrl.status && MadeCtrl.status) == 'INVALID'">
                                    <div class="report-valid valid">
                                        <strong> Не все обязательные поля формы заполнены!</strong>
                                    </div>
                                </div>
                            </div>
                            <div class="button-wrap">
                                <button type="button" class="add-button" (click)="addOnPopup()" [disabled]="(MethodControlCtrl.status && CustomerCtrl.status && CwrWorkPersonalsCtrl.status && CwrWorkEquipmentsCtrl.status && ShownCtrl.status && MadeCtrl.status) == 'INVALID'">
                                  <p class="button-text">Добавить</p>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="reports-popup" [ngClass]="{open:popOpen2}">
            <div class="popup-area" (click)="popupOpen2()"></div>
            <div class="popup-body">
                <div class="popup-content">
                    <a class="popup-close" (click)="popupOpen2()">X</a>
                    <div class="popup-title">Персонал</div>
                    <div class="form" (ngSubmit)='addOnPopup2() '>
                        <form (ngSubmit)='addOnPopup2()'>
                            <div class="select-card-wrap">
                                <div class="select-wrap">
                                    <p class="select-title">Сотрудник ФИО </p>
                                    <app-dropdown-select [ItemsData]="PersData" [ItemsCtrl]="CwrPersonalCtrl" [placeholder]="'Выберите сотрудника'" (itemSelect)="PersonalAdd($event)"></app-dropdown-select>
                                </div>
                                <div class="select-wrap">
                                    <p class="select-title">Функции</p>
                                    <app-dropdown-multi [ItemsData]="StatusData" [ItemsMultiCtrl]="StatusCtrl" [allItemsSize]="status.length" [placeholder]="'Выберите сотрудников'" (itemSelect)="StatusAdd($event)"></app-dropdown-multi>
                                </div>
                                <div class="select-wrap area-wrap">
                                    <p class="select-title">Комментарий</p>
                                    <mat-form-field class="example-full-width" appearance="fill" color="accent">
                                        <mat-label>Leave a comment</mat-label>
                                        <textarea matInput placeholder="Ex. It makes me feel..." [formControl]="CommentCtrl2"></textarea>
                                    </mat-form-field>
                                </div>

                            </div>
                            <div class="button-wrap">
                                <button type="button" class="add-button" (click)="addOnPopup2()"><p class="button-text">Добавить</p> </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="reports-popup" [ngClass]="{open:popOpen3}">
            <div class="popup-area" (click)="popupOpen3()"></div>
            <div class="popup-body">
                <div class="popup-content">
                    <a class="popup-close" (click)="popupOpen3()">X</a>
                    <div class="popup-title">Оборудование</div>
                    <div class="form" (ngSubmit)='addOnPopup3() '>
                        <form (ngSubmit)='addOnPopup3()'>
                            <div class="select-card-wrap">
                                <div class="select-wrap">
                                    <p class="select-title">Оборудование</p>
                                    <app-dropdown-select [ItemsData]="EquipData" [ItemsCtrl]="CwrEquipmentslCtrl" [placeholder]="'Выберите сотрудника'" (itemSelect)="EquipmentAdd($event)"></app-dropdown-select>

                                </div>
                                <div class="select-wrap">
                                    <p class="select-title">Статус</p>
                                    <app-dropdown-select [ItemsData]="StatusEqData" [ItemsCtrl]="StatusEqCtrl" [placeholder]="'Выберите сотрудника'" (itemSelect)="StatusEqAdd($event)"></app-dropdown-select>

                                </div>
                                <div class="select-wrap area-wrap">
                                    <p class="select-title">Комментарий</p>
                                    <mat-form-field class="example-full-width" appearance="fill" color="accent">
                                        <mat-label>Leave a comment</mat-label>
                                        <textarea matInput placeholder="Ex. It makes me feel..." [formControl]="CommentCtrl3"></textarea>
                                    </mat-form-field>
                                </div>

                            </div>
                            <div class="button-wrap">
                                <button type="button" class="add-button" (click)="addOnPopup3()"><p class="button-text">Добавить</p> </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="reports-submit"><button type="submit" class="send-button" (click)="reportSubmit()"><p class="button-text">Отправить</p> </button></div>
    </form>

    <div style="padding-bottom:150px;">


    </div>
</div>

<!-- <div class="loader-wrap">
    <div class="loader-area">

    </div>
</div> -->
<div class="reports-popup" [ngClass]="{open:popLoader}" *ngIf="loading">
    <div class="popup-area"></div>
    <div class="popup-body">
        <div class="loader">
            <mat-spinner color="accent"></mat-spinner>
        </div>
    </div>
</div>


<!-- <mat-form-field appearance="fill">
    <mat-label>Message</mat-label>
    <input matInput value="Disco party!" #message>
</mat-form-field>

<mat-form-field appearance="fill">
    <mat-label>Action</mat-label>
    <input matInput value="Dance" #action>
</mat-form-field> -->